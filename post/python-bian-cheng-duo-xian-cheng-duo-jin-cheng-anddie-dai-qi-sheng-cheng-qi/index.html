<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pythonç¼–ç¨‹â€”å¤šçº¿ç¨‹ä¸è¿­ä»£å™¨ | skkyblu3</title>
<link rel="shortcut icon" href="https://skyblu3519.github.io/favicon.ico?v=1721054258675">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://skyblu3519.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Pythonç¼–ç¨‹â€”å¤šçº¿ç¨‹ä¸è¿­ä»£å™¨ | skkyblu3 - Atom Feed" href="https://skyblu3519.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="ç®€å•çš„ç¼–ç¨‹ç»ƒä¹ ã€‚
èƒŒæ™¯çŸ¥è¯†
ç”¨ç®€å•çš„ä¾‹å­å¿«é€Ÿäº†è§£Pythonçš„å¤šçº¿ç¨‹ä»¥åŠè¿­ä»£å™¨
å¤šçº¿ç¨‹
ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å¤šçº¿ç¨‹çš„ä¾‹å­ï¼š
import threading

def print_numbers():
    for i in range(10..." />
    <meta name="keywords" content="Python,CTF" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://skyblu3519.github.io">
  <img class="avatar" src="https://skyblu3519.github.io/images/avatar.png?v=1721054258675" alt="">
  </a>
  <h1 class="site-title">
    skkyblu3
  </h1>
  <p class="site-description">
    Welcome to Internet
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Pythonç¼–ç¨‹â€”å¤šçº¿ç¨‹ä¸è¿­ä»£å™¨
            </h2>
            <div class="post-info">
              <span>
                2023-06-12
              </span>
              <span>
                13 min read
              </span>
              
                <a href="https://skyblu3519.github.io/tag/c6PC98FOD/" class="post-tag">
                  # Python
                </a>
              
                <a href="https://skyblu3519.github.io/tag/b7GKYdjmj/" class="post-tag">
                  # CTF
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://skyblu3519.github.io/post-images/python-bian-cheng-duo-xian-cheng-duo-jin-cheng-anddie-dai-qi-sheng-cheng-qi.jpeg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <p>ç®€å•çš„ç¼–ç¨‹ç»ƒä¹ ã€‚</p>
<h1 id="èƒŒæ™¯çŸ¥è¯†">èƒŒæ™¯çŸ¥è¯†</h1>
<p>ç”¨ç®€å•çš„ä¾‹å­å¿«é€Ÿäº†è§£Pythonçš„å¤šçº¿ç¨‹ä»¥åŠè¿­ä»£å™¨</p>
<h2 id="å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å¤šçº¿ç¨‹çš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">import threading

def print_numbers():
    for i in range(10):
        print(i)

def print_letters():
    for letter in &quot;abcdefghijklmnopqrstuvwxyz&quot;:
        print(letter)

thread1 = threading.Thread(target=print_numbers)
thread2 = threading.Thread(target=print_letters)

thread1.start()
thread2.start()

thread1.join()
thread2.join()
</code></pre>
<p>ä¸Šè¿°ä»£ç åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š</p>
<ul>
<li>å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ‰“å°0åˆ°9çš„æ•°å­—ï¼Œå¦ä¸€ä¸ªæ‰“å°å­—æ¯aåˆ°zã€‚</li>
<li>åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«å°†ä¸¤ä¸ªå‡½æ•°ä½œä¸ºç›®æ ‡ï¼ˆtargetï¼‰ã€‚</li>
<li>é€šè¿‡<code>start()</code>å°†è®¾ç½®çº¿ç¨‹ä¸ºâ€œå¯åŠ¨â€çŠ¶æ€ï¼Œå¹¶ä¸”Pythonè§£é‡Šå™¨å°†å®‰æ’å…¶æ‰§è¡Œã€‚</li>
<li><code>join()</code>æ–¹æ³•ç”¨äºç­‰å¾…ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹å®Œæˆã€‚å½“ä½ åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨<code>thread1.join()</code>æ—¶ï¼Œä¸»çº¿ç¨‹å°†æš‚åœæ‰§è¡Œï¼Œç›´åˆ°<code>thread1</code>å®Œæˆã€‚ç„¶åï¼Œä½ è°ƒç”¨<code>thread2.join()</code>ï¼Œä¸»çº¿ç¨‹å†æ¬¡æš‚åœï¼Œç­‰å¾…<code>thread2</code>å®Œæˆã€‚</li>
</ul>
<h2 id="è¿­ä»£å™¨">è¿­ä»£å™¨</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„è¿­ä»£å™¨ä¾‹å­ï¼š</p>
<pre><code class="language-python">class Counter:
    def __init__(self, low, high):
        self.current = low
        self.high = high

    def __iter__(self):
        # è¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«
        return self

    def __next__(self):
        # è¿”å›å®¹å™¨çš„ä¸‹ä¸€ä¸ªå€¼
        if self.current &gt; self.high:
            raise StopIteration
        else:
            self.current += 1
            return self.current - 1

counter = Counter(0, 5)
for number in counter:
    print(number)
</code></pre>
<p>åœ¨Pythonä¸­ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ä¸ªå®ç°äº†è¿­ä»£å™¨åè®®ï¼ˆåŒ…å«<code>__iter__()</code>å’Œ<code>__next__()</code>æ–¹æ³•ï¼‰çš„å¯¹è±¡ã€‚</p>
<p>å…¶ä¸­ï¼Œ<code>__iter__()</code>æ–¹æ³•è¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«ï¼Œç„¶ååœ¨è¿­ä»£çš„æ—¶å€™ï¼Œæ¯ä¸€æ¬¡éƒ½ä¼šé€šè¿‡è¿­ä»£å™¨å¯¹è±¡çš„<code>__next__()</code>æ–¹æ³•ç»™å‡ºä¸€ä¸ªå€¼ã€‚</p>
<p>å½“å®¹å™¨ä¸­æ²¡æœ‰æ›´å¤šçš„å…ƒç´ æ—¶ï¼Œ<code>__next__()</code>æ–¹æ³•åº”è¯¥æŠ›å‡ºStopIterationå¼‚å¸¸ã€‚Pythonä¼šè‡ªåŠ¨æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå¹¶åœæ­¢è¿­ä»£ã€‚</p>
<p>æ¥ä¸‹æ¥é€šè¿‡ä¸¤é“é¢˜ç›®åŠ æ·±è¿™ä¸¤éƒ¨åˆ†çš„ç†è§£ã€‚</p>
<h1 id="å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢">[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h1>
<p>ä¸‹è½½æºç www.tar.gz<br>
<img src="https://skyblu3519.github.io/post-images/1686586610611.png" alt="" loading="lazy"></p>
<p>æºç é‡Œæ˜¯ä¸€äº›æ··æ·†è¿‡çš„phpæ–‡ä»¶ï¼Œé»‘å®¢ç•™ä¸‹çš„shellå°±åœ¨å…¶ä¸­ã€‚</p>
<p>å¯¹äºä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å°†å…¶ä¸­æ‰€æœ‰GETå’ŒPOSTè¯·æ±‚çš„å‚æ•°æå–å‡ºæ¥ï¼Œå†æŠŠè¿™äº›å‚æ•°èµ‹ä¸Šå‘½ä»¤ï¼ˆå¦‚<code>echo 519519;</code>ï¼‰å»è¯·æ±‚ã€‚éªŒè¯è¿”å›é¡µé¢çš„å†…å®¹ï¼Œæœ€åæ‰¾åˆ°è¿™ä¸ªshellçš„å‚æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æœç´¢è„šæœ¬ï¼š</p>
<pre><code class="language-python">import os
import re
import requests
import threading
import concurrent.futures
import itertools
import time


def find_backdoor_iteration(filename):
    with open(path + filename) as f:
        php_code = f.read()

    pattern = r&quot;\$_(GET|POST)\['(\w+)'\]&quot;
    matches = re.findall(pattern, php_code)
    parameters = {'GET': [], 'POST': []}
    for match in matches:
        param_type = match[0]
        param_name = match[1]
        parameters[param_type].append(param_name)

    params = {key: command for key in parameters['GET']}
    data = {key: command for key in parameters['POST']}
    resp = requests.post(url+filename, params=params, data=data)

    if '519519' in resp.text:
        print('Find backdoor: '+filename)
        # å¯»æ‰¾æ­£ç¡®çš„å‚æ•°
        method = ''
        resp = requests.get(url + filename, params=params)
        if '519519' in resp.text:
            print('Backdoor in GET!!!')
            method = 'GET'
        resp = requests.post(url + filename, data=data)
        if '519519' in resp.text:
            print('Backdoor in POST!!!')
            method = 'POST'

        keys = parameters[method]
        for key in keys:
            message = {key: command}
            resp = requests.get(url + filename, params=message) if method == 'GET' else requests.post(url + filename, data=message)
            if '519519' in resp.text:
                print('Backdoor is ' + key)
                return True
    return False


query = 'buu/smartHacker/'
path = '/Applications/MAMP/htdocs/' + query     # ä¿å­˜æ–‡ä»¶çš„è·¯å¾„
fileList = os.scandir(path)
command = &quot;echo 519519;&quot;
url = 'http://localhost:8888/' + query      # è¯·æ±‚çš„URL

for file in fileList:
    filename = file.name
    if find_backdoor_iteration(filename):
        break
</code></pre>
<p>å®ç°æœç´¢åé—¨çš„å‡½æ•°<code>find_backdoor_iteration</code>å®ç°é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ¥å—ä¸€ä¸ªæ–‡ä»¶åä½œä¸ºå‚æ•°ã€‚</li>
<li>è¯»å–è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>å°†å…¶ä¸­çš„GETå’ŒPOSTå‚æ•°åç§°é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºæ¥ï¼ŒæŒ‰è¯·æ±‚çš„æ–¹å¼å­˜åˆ°ä¸€ä¸ªå­—å…¸ä¸­ã€‚</li>
<li>å°†æ‰€æœ‰å‚æ•°ç”¨æˆ‘ä»¬çš„å‘½ä»¤èµ‹å€¼å¹¶è¯·æ±‚ç½‘é¡µï¼ŒéªŒè¯æ˜¯å¦å­˜åœ¨åé—¨ã€‚</li>
<li>å¦‚æœå­˜åœ¨åé—¨ï¼Œåˆ™ç»§ç»­éªŒè¯å­˜åœ¨åé—¨çš„å‚æ•°æ˜¯å“ªä¸€ä¸ªã€‚</li>
<li>å¯¹GETå’ŒPOSTçš„å‚æ•°åˆ†åˆ«éªŒè¯ï¼Œæ‰¾åˆ°æœ€åçš„åé—¨ã€‚</li>
</ul>
<p>Ps.</p>
<ul>
<li>è¿™é‡Œç•™çš„åé—¨æ˜¯<code>system</code>çš„ï¼Œåœ¨ä¸€å¼€å§‹ä¸çŸ¥é“æ˜¯<code>eval</code>è¿˜æ˜¯<code>system</code>çš„æƒ…å†µä¸‹ï¼Œç”¨<code>echo 519519;</code>éªŒè¯ï¼Œè¿™ä¸¤ç§æƒ…å†µå‡å¯æ‰¾åˆ°åé—¨ã€‚</li>
<li><code>requests.get(url, params=params)</code>ä½¿ç”¨<code>params=params</code>ä¼ é€’getè¯·æ±‚çš„å‚æ•°ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œurlç¼–ç ã€‚å¦‚æœè‡ªå·±å¯¹payloadè¿›è¡Œurlç¼–ç çš„è¯ï¼Œå°±ä¼šå¯¼è‡´äºŒæ¬¡ç¼–ç ï¼Œè¿›è€Œæ— æ³•éªŒè¯ã€‚</li>
</ul>
<p>æœ€åæˆ‘ä»¬ä¼šæ‰¾åˆ°å­˜åœ¨åé—¨çš„é¡µé¢æ˜¯<code>xk0SzyKwfzw.php</code>ï¼Œå‚æ•°ä¸ºGETè¯·æ±‚çš„<code>Efa5BVG</code>ã€‚</p>
<p>æ•´ä¸ªæœç´¢çš„æ–‡ä»¶æ•°é‡ä¸º3000ï¼Œè®²é“ç†è¿™ä¸ªé‡ä¸æ˜¯å¾ˆå¤§ï¼Œç”¨è¿­ä»£åšä¹Ÿè¡Œäº†ã€‚ä¸è¿‡ç”¨å¤šçº¿ç¨‹è¿˜å¯ä»¥åšå¾—æ›´å¥½ã€‚</p>
<p>ä¸‹é¢æ¥è€ƒè™‘ç”¨å¤šçº¿ç¨‹å¯¹è¿™ä¸€è¿‡ç¨‹åŠ é€Ÿï¼Œè¿™æ˜¯æˆ‘ä¸€å¼€å§‹æƒ³åˆ°çš„æ–¹æ¡ˆï¼š</p>
<pre><code class="language-python">tl = []
for file in fileList:
    filename = file.name
    t = threading.Thread(target=find_backdoor, args=(filename,))
    tl.append(t)
    t.start()
for t in tl:
    t.join()
</code></pre>
<p>éå¸¸çš„ç²—æš´ï¼Œæ²¡æœ‰æ§åˆ¶çº¿ç¨‹çš„æ•°é‡ï¼Œè¿™å¯èƒ½ä¼šæ¶ˆè€—å¾ˆå¤šèµ„æºã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥<strong>çº¿ç¨‹æ± </strong>çš„æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯ç”¨çº¿ç¨‹æ± å¯¹åŸæ–¹æ¡ˆçš„æ”¹è¿›ï¼š</p>
<pre><code class="language-python">import concurrent.futures

with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
    executor.map(find_backdoor_iteration, (file.name for file in fileList))
</code></pre>
<p>åœ¨è¿™ä¸ªä»£ç ä¸­ï¼Œ<code>with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:</code>è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«10ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚</p>
<p>ç„¶åï¼Œ<code>executor.map(find_backdoor_iteration, (file.name for file in fileList))</code>è¿™è¡Œä»£ç å°†<code>find_backdoor_iteration</code>å‡½æ•°åº”ç”¨åˆ°ç”±<code>(file.name for file in fileList)</code>è¿™ä¸ªç”Ÿæˆå™¨è¡¨è¾¾å¼ç”Ÿæˆçš„æ¯ä¸ªå…ƒç´ ã€‚</p>
<p><code>map</code>å‡½æ•°ä¼šè‡ªåŠ¨å°†ä»»åŠ¡åˆ†é…ç»™çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œå¦‚æœçº¿ç¨‹æ± å·²ç»æ»¡äº†ï¼Œé‚£ä¹ˆæ–°çš„ä»»åŠ¡å°±ä¼šç­‰å¾…ï¼Œç›´åˆ°æœ‰çº¿ç¨‹ç©ºé—²ã€‚</p>
<p><code>with</code>è¯­å¥ä¿è¯äº†å½“æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåï¼Œçº¿ç¨‹æ± ä¼šè¢«æ­£ç¡®åœ°å…³é—­ï¼Œæ‰€æœ‰çš„èµ„æºéƒ½ä¼šè¢«æ­£ç¡®åœ°å›æ”¶ã€‚è¿™æ¯”æ‰‹åŠ¨åˆ›å»ºå’Œå›æ”¶çº¿ç¨‹è¦ç®€å•å¾—å¤šã€‚</p>
<p>æ¥ä¸‹æ¥è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªæœç´¢è¿‡ç¨‹ä¼šå°†è¿™3000ä¸ªæ–‡ä»¶å…¨éƒ¨éå†ï¼Œè€Œæˆ‘å¸Œæœ›å®ƒåœ¨æ‰¾åˆ°åé—¨åå¯ä»¥è®©ç¨‹åºç›´æ¥åœæ­¢ã€‚</p>
<p>è§£å†³çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„<code>Event</code>å¯¹è±¡æ¥å¯¹è¿›ç¨‹è¿›è¡Œæ§åˆ¶ï¼Œå½“è°ƒç”¨<code>Event.set()</code>æ—¶ï¼Œ<code>Event.is_set()</code>ä¼šè¿”å›Trueï¼Œå½“è°ƒç”¨<code>Event.clear()</code>æ—¶ï¼Œ<code>Event.is_set()</code>ä¼šè¿”å›Falseã€‚ä¸‹é¢å¯¹åŸæ¥çš„å‡½æ•°è¿›è¡Œä¿®æ”¹ï¼š</p>
<pre><code class="language-python">import concurrent.futures
import threading

def find_backdoor_thread(filename):
    if stop_event.is_set():
        return
    # æœç´¢ä»£ç ......
    if filename == 'backdoor':
        stop_event.set()

stop_event = threading.Event()
with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
    executor.map(find_backdoor_thread, (file.name for file in fileList))
</code></pre>
<p>ä¸‹é¢å¯¹æ¯”ä¸¤ç§æœç´¢æ–¹å¼æ‰€è€—çš„æ—¶é—´ï¼š</p>
<pre><code class="language-python">print('+---å¼€å§‹è¿­ä»£æœç´¢---+')
start_time = time.time()
for file in fileList:
    filename = file.name
    if find_backdoor_iteration(filename):
        break
end_time = time.time()
print('è¿­ä»£æœç´¢çš„è¿è¡Œæ—¶é—´ï¼š', end_time - start_time, 'ç§’')

stop_event = threading.Event()
fileList = os.scandir(path)
print('+---å¼€å§‹å¤šçº¿ç¨‹æœç´¢---+')
start_time = time.time()
with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
    executor.map(find_backdoor_thread, (file.name for file in fileList))
end_time = time.time()
print('å¤šçº¿ç¨‹æœç´¢çš„è¿è¡Œæ—¶é—´ï¼š', end_time - start_time, 'ç§’')
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://skyblu3519.github.io/post-images/1686591312419.png" alt="" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨å¤šçº¿ç¨‹æ•ˆç‡çš„æå‡è¿˜æ˜¯éå¸¸æ˜¾è‘—çš„ï½</p>
<h1 id="bjdctf2020easysearch">[BJDCTF2020]EasySearch</h1>
<p>æºç åœ¨index.php.swp<br>
<img src="https://skyblu3519.github.io/post-images/1686592012870.png" alt="" loading="lazy"></p>
<p>è¿™é‡Œå…³æ³¨ä¸€ä¸‹å¦‚ä½•æ‰¾åˆ°è¿™æ ·çš„passwordï¼Œä½¿å…¶md5åå‰6ä¸ªå­—ç¬¦ä¸º<code>6d0bc1</code>ã€‚</p>
<p>æ€è·¯å¾ˆç®€å•ï¼š</p>
<ul>
<li>å†™ä¸€ä¸ªå‡½æ•°<code>generateString()</code>ï¼Œç”¨äºç”ŸæˆæŒ‡å®šå­—ç¬¦é›†<code>charset</code>ä¸­æ‰€æœ‰é•¿åº¦ä¸º<code>length</code>çš„å­—ç¬¦ä¸²çš„ç»„åˆã€‚</li>
<li>å†™ä¸€ä¸ªå‡½æ•°<code>md5()</code>ç”¨äºè®¡ç®—å­—ç¬¦ä¸²çš„md5å€¼ã€‚</li>
<li>åŒ¹é…å‡ºå‰ç¼€ç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²ã€‚</li>
</ul>
<pre><code class="language-python">import hashlib


def generateString(charset, c, l):
    if l == 0:
        strList.append(c)
        return c
    else:
        for char in charset:
            generateString(charset, char + c, l - 1)


def md5(string):
    md5_hash = hashlib.md5()
    md5_hash.update(string.encode('utf-8'))
    md5_value = md5_hash.hexdigest()

    return md5_value


charset = '0123456789'
length = 7
strList = []
generateString(charset, '', length)
for s in strList:
    if md5(s).startswith('6d0bc1'):
        print('Find it: '+s)
</code></pre>
<p>åŒæ ·ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æ‰¾åˆ°æƒ³è¦çš„å­—ç¬¦ä¸²ï¼Œä½†è¿˜å¯ä»¥åšå¾—æ›´å¥½ã€‚</p>
<p>è¿™é‡Œå­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜æ˜¯â€œåœ¨å­—ç¬¦é›†è¿‡å¤§æˆ–è€…é•¿åº¦éœ€è¦æ›´é•¿çš„æƒ…å†µä¸‹ï¼ŒstrListä¼šå˜å¾—éå¸¸é‡ï¼Œå­˜å‚¨è¿™ä¸ªåˆ—è¡¨ä¼šæ¶ˆè€—å¾ˆå¤šå†…å­˜ï¼Œè®¾ç½®ä¼šæœ‰è¶…å‡ºå­˜å‚¨é•¿åº¦çš„æƒ…å†µå‡ºç°ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸€æ¬¡ç”Ÿæˆçš„å­—ç¬¦ä¸²åªåœ¨éœ€è¦çš„æ—¶å€™æ‰å¼€å§‹è®¡ç®—ï¼Œä¸ç”¨å¼€å§‹å°±å…¨éƒ¨è®¡ç®—å­˜å‚¨å¥½ã€‚è¿™é‡Œæˆ‘ä»¬å¼•å…¥è¿­ä»£å™¨ï¼Œè¿­ä»£å™¨å¯ä»¥å®ç°æƒ°æ€§æ±‚å€¼ï¼ˆlazy evaluationï¼‰ï¼Œå³åªåœ¨çœŸæ­£éœ€è¦è®¡ç®—å…ƒç´ çš„å€¼æ—¶æ‰è®¡ç®—ã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆæŠŠæˆ‘ä»¬çš„é€’å½’å‡½æ•°å¼•å…¥åˆ°ä¸€ä¸ªç”Ÿæˆå™¨ä¸­å‘¢ï¼Ÿåƒä¸‹é¢è¿™æ ·ï¼Ÿ</p>
<pre><code class="language-python">class Counter:
    def __init__(self, charset, length):
        self.charset = charset
        self.length = length

    def __iter__(self):
        return self

    def __next__(self):
        generateString(self.charset, '', self.length)
        raise StopIteration
</code></pre>
<p>æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œ<code>generateString</code>ä¸ä¼šæ¯ä¸€æ¬¡è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å‡ºæ¥ï¼Œè€Œä¸”å®ƒå†…éƒ¨çš„è¿­ä»£çŠ¶æ€ä¹Ÿä¸ä¼šè¢«è¿­ä»£å™¨ä¿å­˜ã€‚ä»”ç»†æ€è€ƒåå°±ä¼šå‘ç°ï¼Œå°†å‡½æ•°ç›´æ¥æ”¾åˆ°è¿­ä»£å™¨è¿™ç§æ–¹æ³•æ˜¯è¡Œä¸é€šçš„ã€‚</p>
<p>è¿™æ—¶æˆ‘ä»¬å¼•å…¥Pythonç”Ÿæˆå™¨ï¼Œç”Ÿæˆå™¨æ˜¯Pythonä¸­ä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ï¼Œåªè¦ä¸€ä¸ªå‡½æ•°æœ‰yieldå®ƒå°±æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ã€‚å½“ä¸€æ¬¡è¿­ä»£æ‰§è¡Œåˆ°yieldæ—¶å€™å°±ä¼šæš‚åœè¿”å›yieldåé¢çš„ç»“æœï¼Œç„¶åä¸‹ä¸€æ¬¡è¿­ä»£çš„æ—¶å€™åˆä»ä¸Šä¸€æ¬¡yieldæš‚åœçš„åœ°æ–¹ç»§ç»­è¿è¡Œã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨ç”Ÿæˆå™¨å®ç°ä¸Šé¢çš„æ•ˆæœï¼š</p>
<pre><code class="language-python">class CombinationGenerator:
    def __init__(self, charset, length):
        self.charset = charset
        self.length = length

    def __iter__(self):     # ç”¨__iter__è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ã€‚
        return self.generateString(self.charset, '', self.length)

    def generateString(self, charset, c, l):
        if l == 0:
            yield c
        else:
            for char in charset:
                yield from self.generateString(charset, c + char, l - 1)
</code></pre>
<p>æ³¨æ„è¿™é‡Œä½¿ç”¨äº†<code>yield from</code>åœ¨ç”Ÿæˆå™¨ä¸­æ›´æ–¹ä¾¿åœ°å¤„ç†åµŒå¥—çš„è¿­ä»£ã€‚<code>yield from &lt;expression&gt;</code>çš„è¡¨è¾¾å¼éƒ¨åˆ†å¿…é¡»æ˜¯å¦ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œ<code>yield from</code>ä¼šä»è¿™ä¸ªè¿­ä»£å¯¹è±¡ä¸­è·å–å€¼ï¼Œå¹¶åœ¨æ¯æ¬¡è¿­ä»£æ—¶<code>yield</code>è¿™äº›å€¼ï¼Œè¿™é‡Œ<code>yield from</code>ä¹Ÿèµ·åˆ°ä¸€ä¸ªé€’å½’è°ƒç”¨çš„æ•ˆæœã€‚</p>
<p>ä¸‹é¢æ˜¯æœ€åçš„ä»£ç ï¼š</p>
<pre><code class="language-python">import hashlib
import concurrent.futures


class CombinationGenerator:
    def __init__(self, charset, length):
        self.charset = charset
        self.length = length

    def __iter__(self):
        return self.generateString(self.charset, '', self.length)

    def generateString(self, charset, c, l):
        if l == 0:
            yield c
        else:
            for char in charset:
                yield from self.generateString(charset, c + char, l - 1)


def md5(string):
    md5_hash = hashlib.md5()
    md5_hash.update(string.encode('utf-8'))
    md5_value = md5_hash.hexdigest()

    return md5_value


if __name__ == '__main__':
    combination_generator = CombinationGenerator('qwertyuiopasdfghjklzxcvbnm', 6)
    
    for combination in combination_generator:
        result = md5(combination)
        if result.startswith('6d0bc1'):
            print('Find it: ' + combination)
</code></pre>
<p>åŒæ ·<code>combination_generator</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œè¿™ä¹Ÿæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨åˆ°å¤šçº¿ç¨‹ä¸­ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢ä½¿ç”¨å¤šçº¿ç¨‹æ¥åŠ é€Ÿè¿™ä¸€æœç´¢è¿‡ç¨‹.....å—ï¼Ÿ</p>
<pre><code class="language-python">def ezSearch(string):
    # print('Test: ' + string)
    result = md5(string)
    if result.startswith('6d0bc1'):
        print('Find it: ' + string, flush=True)

if __name__ == '__main__':
    combination_generator = CombinationGenerator('qwertyuiopasdfghjklzxcvbnm', 6)

    with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
        executor.map(ezSearch, combination_generator)
</code></pre>
<p>ç»è¿‡æµ‹è¯•åï¼Œæˆ‘ä»¬å‘ç°è¿™é‡Œä½¿ç”¨å¤šçº¿ç¨‹ä¸ä½†æ²¡æœ‰åŠ é€Ÿæœç´¢ï¼Œåè€Œè®©æ—¶é—´å˜é•¿äº†ã€‚è¿™æ˜¯ç”±äºPythonçš„å…¨å±€è§£é‡Šå™¨é”ï¼ˆGlobal Interpreter Lock, GILï¼‰é€ æˆçš„ã€‚</p>
<p>åœ¨Pythonä¸­ï¼Œå…¨å±€è§£é‡Šå™¨é”æ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨äºåŒæ­¥å¤šçº¿ç¨‹çš„æ‰§è¡Œï¼Œä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œã€‚è¿™ç§è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å¤šçº¿ç¨‹å¹¶å‘æ“ä½œå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå…¨å±€è§£é‡Šå™¨é”ä¹Ÿé™åˆ¶äº†Pythonçš„å¤šçº¿ç¨‹å¹¶å‘æ€§èƒ½ï¼šåœ¨CPUå¯†é›†å‹ä»»åŠ¡ä¸­ï¼ŒPythonçš„å¤šçº¿ç¨‹ç”šè‡³å¯èƒ½æ¯”å•çº¿ç¨‹æ›´æ…¢ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨IOå¯†é›†å‹ä»»åŠ¡ä¸­ï¼Œä¾‹å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼ŒPythonçš„å¤šçº¿ç¨‹ä»ç„¶å¯ä»¥å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œå› ä¸ºè¿™äº›ä»»åŠ¡çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…IOæ“ä½œï¼Œè€ŒéCPUè®¡ç®—ã€‚åœ¨ç­‰å¾…IOçš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥å¾—åˆ°æ‰§è¡Œã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœåœ¨åšçš„æ˜¯CPUå¯†é›†å‹ä»»åŠ¡ï¼Œä¾‹å¦‚è®¡ç®—MD5å“ˆå¸Œï¼Œå¯èƒ½ä¼šå‘ç°å¤šçº¿ç¨‹å¹¶æ²¡æœ‰å¸¦æ¥æ€§èƒ½æå‡ï¼Œç”šè‡³å˜æ…¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å¤šè¿›ç¨‹ï¼ˆä¾‹å¦‚ä½¿ç”¨<code>multiprocessing</code>æ¨¡å—ï¼‰ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–å¯ä»¥é¿å¼€GILé™åˆ¶çš„æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨Jythonæˆ–è€…PyPyè¿™æ ·çš„Pythonå®ç°ï¼Œæˆ–è€…ä½¿ç”¨Cythonè¿™æ ·çš„å·¥å…·å°†å…³é”®ä»£ç ç¼–è¯‘ä¸ºCä»£ç ã€‚ï¼ˆChatGPTğŸ‚ï¼‰</p>
<p>ä¸‹é¢åœ¨å­—ç¬¦é›†æ•°å­—ï¼Œé•¿åº¦ä¸º7çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹è¿™ä¸‰ç§æ–¹æ³•ï¼ˆè¿­ä»£ã€å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ï¼‰æ‰€è€—çš„æ—¶é—´ï¼š</p>
<pre><code class="language-python">if __name__ == '__main__':
    combination_generator = CombinationGenerator('0123456789', 7)
    print('+---å¼€å§‹è¿­ä»£æœç´¢---+')
    start_time = time.time()
    for combination in combination_generator:
        result = md5(combination)
        if result.startswith('6d0bc1'):
            print('Find it: ' + combination)
    end_time = time.time()
    print('è¿­ä»£æœç´¢æ—¶é—´ï¼š', end_time - start_time, 'ç§’')

    combination_generator = CombinationGenerator('0123456789', 7)
    print('+---å¼€å§‹å¤šçº¿ç¨‹æœç´¢---+')
    start_time = time.time()
    with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
        executor.map(ezSearch, combination_generator)
    end_time = time.time()
    print('å¤šçº¿ç¨‹æœç´¢çš„æ—¶é—´ï¼š', end_time - start_time, 'ç§’')

    combination_generator = CombinationGenerator('0123456789', 7)
    print('+---å¼€å§‹å¤šè¿›ç¨‹æœç´¢---+')
    start_time = time.time()
    with multiprocessing.Pool(processes=10) as pool:
        pool.map(ezSearch, combination_generator)
    end_time = time.time()
    print('å¤šè¿›ç¨‹æœç´¢çš„æ—¶é—´ï¼š', end_time - start_time, 'ç§’')
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://skyblu3519.github.io/post-images/1686598363282.png" alt="" loading="lazy"></figure>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<figure data-type="image" tabindex="3"><img src="https://skyblu3519.github.io/post-images/1686598179345.jpeg" alt="" loading="lazy"></figure>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86">èƒŒæ™¯çŸ¥è¯†</a>
<ul>
<li><a href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B">å¤šçº¿ç¨‹</a></li>
<li><a href="#%E8%BF%AD%E4%BB%A3%E5%99%A8">è¿­ä»£å™¨</a></li>
</ul>
</li>
<li><a href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019%E9%AB%98%E6%98%8E%E7%9A%84%E9%BB%91%E5%AE%A2">[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</a></li>
<li><a href="#bjdctf2020easysearch">[BJDCTF2020]EasySearch</a></li>
<li><a href="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://skyblu3519.github.io/post/2023-an-xun-bei-sai-hou-zong-jie-kuai-su-ban/">
              <h3 class="post-title">
                [2023SYCTF&#34;å®‰æ´µæ¯&#34;]èµ›åæ€»ç»“ï¼ˆæ‘†çƒ‚ç‰ˆï¼‰
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://skyblu3519.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
